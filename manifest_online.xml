<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:type="TaskPaneApp">

  <!-- ========== 基础信息 ========== -->
  <Id>28d4a3e2-65c6-43d0-9c3b-0a336ab67701</Id>
  <Version>1.1.0.0</Version>
  <ProviderName>HTML Report Add-in</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>

  <DisplayName DefaultValue="HTML Report Viewer (Online Compatible)"/>
  <Description DefaultValue="View HTML dashboards in Excel Online and Desktop"/>
  <IconUrl DefaultValue="https://via.placeholder.com/32x32.png"/>
  <HighResolutionIconUrl DefaultValue="https://via.placeholder.com/64x64.png"/>

  <!-- ========== 支持信息（显示为可信任来源） ========== -->
  <SupportUrl DefaultValue="https://github.com/your-repo"/>

  <!-- ========== 允许访问的域 ========== -->
  <AppDomains>
    <AppDomain>https://8080-ibcq34tzqozbvcxg5c7o0-b334fc63.e2b.dev</AppDomain>
    <AppDomain>https://github.com</AppDomain>
    <AppDomain>https://lizheng.me</AppDomain>
  </AppDomains>

  <!-- ========== 宿主应用：支持所有 Excel 版本 ========== -->
  <Hosts>
    <Host Name="Workbook"/>
  </Hosts>

  <!-- ========== 权限 ========== -->
  <Permissions>ReadWriteDocument</Permissions>

  <!-- ========== Office.js API 需求 ========== -->
  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <Set Name="ExcelApi" MinVersion="1.1"/>
      <Set Name="SharedRuntime" MinVersion="1.1"/>
    </Sets>
  </Requirements>

  <!-- ========== 默认设置 ========== -->
  <DefaultSettings>
    <SourceLocation
        DefaultValue="https://8080-ibcq34tzqozbvcxg5c7o0-b334fc63.e2b.dev/focus-management.html"/>
  </DefaultSettings>

  <!-- ========== 版本覆盖：兼容 Excel Online ========== -->
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/taskpaneappversionoverrides/1.1"
                    xsi:type="VersionOverridesV1_1">
    <Hosts>
      <Host xsi:type="Workbook">

        <!-- ★ 共享运行时 -->
        <Runtimes>
          <Runtime resid="Taskpane.Url" lifetime="long"/>
        </Runtimes>

        <!-- ★ 功能区按钮 -->
        <ExtensionPoint xsi:type="PrimaryCommandSurface">
          <OfficeTab id="TabHome">
            <Group id="ReportGroup" label="HTML Reports">
              <Control xsi:type="Button" id="ShowPane"
                       label="Open Dashboard"
                       screentip="Show HTML dashboard"
                       supertip="Launch the report viewer task-pane"
                       icon="Icon.32"
                       onAction="launch"/>
            </Group>
          </OfficeTab>
        </ExtensionPoint>

        <!-- ★ 任务窗格入口 -->
        <ExtensionPoint xsi:type="PrimaryCommandSurface">
          <OfficeTab id="TabHome">
            <Group id="ReportGroup" label="HTML Reports">
              <Control xsi:type="Button" id="TaskpaneButton"
                       label="HTML Viewer"
                       screentip="HTML Report Viewer"
                       supertip="Open HTML Report Viewer"
                       icon="Icon.32">
                <Action xsi:type="ShowTaskpane">
                  <SourceLocation resid="Taskpane.Url"/>
                </Action>
              </Control>
            </Group>
          </OfficeTab>
        </ExtensionPoint>

      </Host>
    </Hosts>

    <!-- ★ 资源表 -->
    <Resources>
      <bt:Urls>
        <bt:Url id="Taskpane.Url"
                DefaultValue="https://8080-ibcq34tzqozbvcxg5c7o0-b334fc63.e2b.dev/focus-management.html"/>
      </bt:Urls>
      <bt:Images>
        <bt:Image id="Icon.32" DefaultValue="https://via.placeholder.com/32x32.png"/>
      </bt:Images>
    </Resources>
  </VersionOverrides>
</OfficeApp> 